<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <!-- FOLHA DE ESTILO NOSSA-->
    <link rel="stylesheet" href="src/css/style.css">
    <!-- FOLHA DE ESTILO DE ANIMA√á√ïES [OPICIONAL]-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/vaibhav111tandon/vov.css@latest/vov.css ">
    <!--Icone da aba [ guia ] do navegador-->
    <link rel="shortcut icon" href="src/img/icon-pneu.png" type="image/x-icon">
    <title>Pneu - Login</title>
</head>

<body class="banner-page">
    <!-- INICIO DO HEADER [CABE√áALHO] -  ABAIXO FICAR√Å O LOGTIPO E MENU DE NAVEGA√á√ÉO-->
    <header>
        <nav class="container">
            <h1 class="middle">
                <img src="src/img/icon-pneu.png" alt="Icone de" class="icon-header">
                Pneu
            </h1>
            <ul class="middle">
                <li>
                    <a class="link" href="index.html">Home</a>
                </li>
                <li>
                    <a class="link" href="sobre.html">Sobre</a>
                </li>
                <li>
                    <a class="link" href="projeto.html">Projeto</a>
                </li>
                <li>
                    <a class="link" href="equipe.html">Equipe</a>
                </li>
                <li>
                    <a class="link" href="login.html" class="current">Login</a>
                </li>
            </ul>
        </nav>
    </header>
    <!-- FIM DO HEADER [CABE√áALHO] -  ACIMA FICAR√Å O LOGTIPO E MENU DE NAVEGA√á√ÉO-->
    <!-- INICIO DO MAIN-  ONDE O CONTE√öDO DA PAGINA ALTERA-->
    
    <main class="container" style="height: 90vh;">
        <!-- DESENVOVA SUA  P√ÅGINA  AQUI DENTRO üòò-->
        <form id="form_login">
           <span class="title-form" > Login</span><br>

            <label for="txtNomeUser">Nome de usu√°rio:</label>
            <input id="txtNomeUser" name="login">

            <label for="txtSenha">Senha:</label>
            <input id="txtSenha" type="password" name="senha">

            <button type="submit" onclick="return entrar()">Entrar</button>
            <a class="link-form" href="cadastro.html"> Cadastro</a>
            <a class="link-form" href="esqueciSenha.html">Esqueceu a senha?</a>
        </form>


    </main>
    
    <!-- FIM DO MAIN-  ONDE O CONTE√öDO DA PAGINA ALTERA-->

    <!-- INICIO DO FOOTER [RODAP√â] -->
    <footer>
        <p class="container">
            &copy;2020 - Projeto<span class="highlight" role="text">Pneu</span>. Desenvolvido com
            <span class="highlight" role="text"> ‚ù§</span> por
            <span class="highlight" role="text"> { DuckDevelopers } </span>
        </p>
    </footer>
    <!-- FIM DO FOOTER [RODP√â] -->

    <!-- ABAIXO DESTE COMENT√ÅRIO FICAR√Å AS CHAMADAS DE SCRIPTS JS -->
    <!-- Script javascript nosso -->
    <script src="src/js/main.js"></script>
</body>

</html>
<script>


        function entrar() {
        
        var formulario = new URLSearchParams(new FormData(form_login));
        fetch("/usuarios/autenticar", {
            method: "POST",
            body: formulario
        }).then(resposta => {
            if (resposta.ok) {

                resposta.json().then(json => {
                    console.log(json.cargoUsuario)
                    sessionStorage.id_usuario_meuapp = json.idLogin;
                    sessionStorage.nome_usuario_meuapp = json.nomeUsuario;
                    sessionStorage.fk_usuario_meuapp = json.fkCliente;
                    sessionStorage.cargo_usuario_meuapp = json.CargoUsuario;
                    window.location.href = 'perfil.html';
                });

            } else {

                console.log('Erro de login!');

                response.text().then(texto => {
                    console.error(texto);                    
                });
            }
        });

        return false;
    }

</script>